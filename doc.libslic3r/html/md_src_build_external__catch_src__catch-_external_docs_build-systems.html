<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libslic3r: build-systems</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libslic3r
   </div>
   <div id="projectbrief">Library for generating gcode from 3d models</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">build-systems </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="top"></a> </p><h1>CI and build system integration</h1>
<p>Build Systems may refer to low-level tools, like CMake, or larger systems that run on servers, like Jenkins or TeamCity. This page will talk about both.</p>
<h2>Continuous Integration systems</h2>
<p>Probably the most important aspect to using <a class="el" href="namespace_catch.html">Catch</a> with a build server is the use of different reporters. <a class="el" href="namespace_catch.html">Catch</a> comes bundled with three reporters that should cover the majority of build servers out there - although adding more for better integration with some is always a possibility (currently we also offer TeamCity, TAP and Automake reporters).</p>
<p>Two of these reporters are built in (XML and JUnit) and the third (TeamCity) is included as a separate header. It's possible that the other two may be split out in the future too - as that would make the core of <a class="el" href="namespace_catch.html">Catch</a> smaller for those that don't need them.</p>
<h3>XML Reporter</h3>
<div class="fragment"><div class="line"> {-r}</div>
<div class="line"> </div>
<div class="line">The XML Reporter writes in an XML format that is specific to Catch. </div>
<div class="line"> </div>
<div class="line">The advantage of this format is that it corresponds well to the way Catch works (especially the more unusual features, such as nested sections) and is a fully streaming format - that is it writes output as it goes, without having to store up all its results before it can start writing.</div>
<div class="line"> </div>
<div class="line">The disadvantage is that, being specific to Catch, no existing build servers understand the format natively. It can be used as input to an XSLT transformation that could convert it to, say, HTML - although this loses the streaming advantage, of course.</div>
<div class="line"> </div>
<div class="line">### JUnit Reporter</div>
<div class="line">```-r juni</div>
</div><!-- fragment --><p>The JUnit Reporter writes in an XML format that mimics the JUnit ANT schema.</p>
<p>The advantage of this format is that the JUnit Ant schema is widely understood by most build servers and so can usually be consumed with no additional work.</p>
<p>The disadvantage is that this schema was designed to correspond to how JUnit works - and there is a significant mismatch with how <a class="el" href="namespace_catch.html">Catch</a> works. Additionally the format is not streamable (because opening elements hold counts of failed and passing tests as attributes) - so the whole test run must complete before it can be written.</p>
<h2>Other reporters</h2>
<p>Other reporters are not part of the single-header distribution and need to be downloaded and included separately. All reporters are stored in <code>include/reporters</code> directory in the git repository, and are named <code>catch_reporter_*.hpp</code>. For example, to use the TeamCity reporter you need to download <code><a class="el" href="catch__reporter__teamcity_8hpp.html">include/reporters/catch_reporter_teamcity.hpp</a></code> and include it after <a class="el" href="namespace_catch.html">Catch</a> itself.</p>
<div class="fragment"><div class="line">#define CATCH_CONFIG_MAIN</div>
<div class="line">#include &quot;catch.hpp&quot;</div>
<div class="line">#include &quot;catch_reporter_teamcity.hpp&quot;</div>
</div><!-- fragment --><h3>TeamCity Reporter</h3>
<div class="fragment"><div class="line"> {-r}</div>
<div class="line"> </div>
<div class="line">The TeamCity Reporter writes TeamCity service messages to stdout. In order to be able to use this reporter an additional header must also be included.</div>
<div class="line"> </div>
<div class="line">Being specific to TeamCity this is the best reporter to use with it - but it is completely unsuitable for any other purpose. It is a streaming format (it writes as it goes) - although test results don&#39;t appear in the TeamCity interface until the completion of a suite (usually the whole test run).</div>
<div class="line"> </div>
<div class="line">### Automake Reporter</div>
<div class="line">```-r automak</div>
</div><!-- fragment --><p>The Automake Reporter writes out the <a href="https://www.gnu.org/software/automake/manual/html_node/Log-files-generation-and-test-results-recording.html#Log-files-generation-and-test-results-recording">meta tags</a> expected by automake via <code>make check</code>.</p>
<h3>TAP (Test Anything Protocol) Reporter</h3>
<div class="fragment"><div class="line"> {-r}</div>
<div class="line"> </div>
<div class="line">Because of the incremental nature of Catch&#39;s test suites and ability to run specific tests, our implementation of TAP reporter writes out the number of tests in a suite last.</div>
<div class="line"> </div>
<div class="line">## Low-level tools</div>
<div class="line"> </div>
<div class="line">### CMake</div>
<div class="line"> </div>
<div class="line">In general we recommend &quot;vendoring&quot; Catch&#39;s single-include releases inside your own repository. If you do this, the following example shows a minimal CMake project:</div>
<div class="line">```CMake</div>
<div class="line">cmake_minimum_required(VERSION 3.0)</div>
<div class="line"> </div>
<div class="line">project(cmake_test)</div>
<div class="line"> </div>
<div class="line"># Prepare &quot;Catch&quot; library for other executables</div>
<div class="line">set(CATCH_INCLUDE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/catch)</div>
<div class="line">add_library(Catch INTERFACE)</div>
<div class="line">target_include_directories(Catch INTERFACE ${CATCH_INCLUDE_DIR})</div>
<div class="line"> </div>
<div class="line"># Make test executable</div>
<div class="line">set(TEST_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/main.cpp)</div>
<div class="line">add_executable(tests ${TEST_SOURCES})</div>
<div class="line">target_link_libraries(tests Catch)</div>
</div><!-- fragment --><p>Note that it assumes that the path to the <a class="el" href="namespace_catch.html">Catch</a>'s header is <code>catch/catch.hpp</code> from the <code>CMakeLists.txt</code> file.</p>
<p>You can also use the following CMake snippet to automatically fetch the entire <a class="el" href="namespace_catch.html">Catch</a> repository from github and configure it as an external project: </p><div class="fragment"><div class="line">cmake_minimum_required(VERSION 2.8.8)</div>
<div class="line">project(catch_builder CXX)</div>
<div class="line">include(ExternalProject)</div>
<div class="line">find_package(Git REQUIRED)</div>
<div class="line"> </div>
<div class="line">ExternalProject_Add(</div>
<div class="line">    catch</div>
<div class="line">    PREFIX ${CMAKE_BINARY_DIR}/catch</div>
<div class="line">    GIT_REPOSITORY https://github.com/philsquared/Catch.git</div>
<div class="line">    TIMEOUT 10</div>
<div class="line">    UPDATE_COMMAND ${GIT_EXECUTABLE} pull</div>
<div class="line">    CONFIGURE_COMMAND &quot;&quot;</div>
<div class="line">    BUILD_COMMAND &quot;&quot;</div>
<div class="line">    INSTALL_COMMAND &quot;&quot;</div>
<div class="line">    LOG_DOWNLOAD ON</div>
<div class="line">   )</div>
<div class="line"> </div>
<div class="line"># Expose required variable (CATCH_INCLUDE_DIR) to parent scope</div>
<div class="line">ExternalProject_Get_Property(catch source_dir)</div>
<div class="line">set(CATCH_INCLUDE_DIR ${source_dir}/single_include CACHE INTERNAL &quot;Path to include folder for Catch&quot;)</div>
</div><!-- fragment --><p>If you put it in, e.g., <code>${PROJECT_SRC_DIR}/${EXT_PROJECTS_DIR}/catch/</code>, you can use it in your project by adding the following to your root CMake file:</p>
<div class="fragment"><div class="line"># Includes Catch in the project:</div>
<div class="line">add_subdirectory(${EXT_PROJECTS_DIR}/catch)</div>
<div class="line">include_directories(${CATCH_INCLUDE_DIR} ${COMMON_INCLUDES})</div>
<div class="line">enable_testing(true)  # Enables unit-testing.</div>
</div><!-- fragment --><p>The advantage of this approach is that you can always automatically update <a class="el" href="namespace_catch.html">Catch</a> to the latest release. The disadvantage is that it means bringing in lot more than you need.</p>
<h3>Automatic test registration</h3>
<p>If you are also using ctest, <code>contrib/ParseAndAddCatchTests.cmake</code> is a CMake script that attempts to parse your test files and automatically register all test cases, using tags as labels. This means that these </p><div class="fragment"><div class="line"><a class="code" href="include_2catch_8hpp.html#abd6e2aec703006b3da62cf7860c9808f">TEST_CASE</a>(<span class="stringliteral">&quot;Test1&quot;</span>, <span class="stringliteral">&quot;[unit]&quot;</span>) {</div>
<div class="line">    <span class="keywordtype">int</span> a = 1;</div>
<div class="line">    <span class="keywordtype">int</span> b = 2;</div>
<div class="line">    <a class="code" href="include_2catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a>(a == b);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="include_2catch_8hpp.html#abd6e2aec703006b3da62cf7860c9808f">TEST_CASE</a>(<span class="stringliteral">&quot;Test2&quot;</span>) {</div>
<div class="line">    <span class="keywordtype">int</span> a = 1;</div>
<div class="line">    <span class="keywordtype">int</span> b = 2;</div>
<div class="line">    <a class="code" href="include_2catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a>(a == b);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="include_2catch_8hpp.html#abd6e2aec703006b3da62cf7860c9808f">TEST_CASE</a>(<span class="stringliteral">&quot;Test3&quot;</span>, <span class="stringliteral">&quot;[a][b][c]&quot;</span>) {</div>
<div class="line">    <span class="keywordtype">int</span> a = 1;</div>
<div class="line">    <span class="keywordtype">int</span> b = 2;</div>
<div class="line">    <a class="code" href="include_2catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a>(a == b);</div>
<div class="line">}</div>
</div><!-- fragment --><p>would be registered as 3 tests, <code>Test1</code>, <code>Test2</code> and <code>Test3</code>, and ctest 4 labels would be created, <code>a</code>, <code>b</code>, <code>c</code> and <code>unit</code>.</p>
<h3>CodeCoverage module (GCOV, LCOV...)</h3>
<p>If you are using GCOV tool to get testing coverage of your code, and are not sure how to integrate it with CMake and <a class="el" href="namespace_catch.html">Catch</a>, there should be an external example over at <a href="https://github.com/fkromer/catch_cmake_coverage">https://github.com/fkromer/catch_cmake_coverage</a></p>
<hr  />
<p><a href="Readme.md#top">Home</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="ainclude_2catch_8hpp_html_abd6e2aec703006b3da62cf7860c9808f"><div class="ttname"><a href="include_2catch_8hpp.html#abd6e2aec703006b3da62cf7860c9808f">TEST_CASE</a></div><div class="ttdeci">#define TEST_CASE(...)</div><div class="ttdef"><b>Definition:</b> catch.hpp:11844</div></div>
<div class="ttc" id="ainclude_2catch_8hpp_html_ad57835ba8f1bb419a865ada6bd011a85"><div class="ttname"><a href="include_2catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a></div><div class="ttdeci">#define REQUIRE(...)</div><div class="ttdef"><b>Definition:</b> catch.hpp:11809</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
