<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libslic3r: assertions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libslic3r
   </div>
   <div id="projectbrief">Library for generating gcode from 3d models</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">assertions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="top"></a> </p><h1>Assertion Macros</h1>
<p><b>Contents</b><br  />
 <a href="#natural-expressions">Natural Expressions</a><br  />
 <a href="#exceptions">Exceptions</a><br  />
 <a href="#matcher-expressions">Matcher expressions</a><br  />
 <a href="#thread-safety">Thread Safety</a><br  />
</p>
<p>Most test frameworks have a large collection of assertion macros to capture all possible conditional forms (<code>_EQUALS</code>, <code>_NOTEQUALS</code>, <code>_GREATER_THAN</code> etc).</p>
<p><a class="el" href="namespace_catch.html">Catch</a> is different. Because it decomposes natural C-style conditional expressions most of these forms are reduced to one or two that you will use all the time. That said there are a rich set of auxilliary macros as well. We'll describe all of these here.</p>
<p>Most of these macros come in two forms:</p>
<h2>Natural Expressions</h2>
<p>The <code>REQUIRE</code> family of macros tests an expression and aborts the test case if it fails. The <code>CHECK</code> family are equivalent but execution continues in the same test case even if the assertion fails. This is useful if you have a series of essentially orthogonal assertions and it is useful to see all the results rather than stopping at the first failure.</p>
<ul>
<li><b>REQUIRE(** <em>expression</em> **)</b> and <br  />
</li>
<li><b>CHECK(** <em>expression</em> **)</b></li>
</ul>
<p>Evaluates the expression and records the result. If an exception is thrown it is caught, reported, and counted as a failure. These are the macros you will use most of the time</p>
<p>Examples: </p><div class="fragment"><div class="line">CHECK( str == &quot;string value&quot; );</div>
<div class="line">CHECK( thisReturnsTrue() );</div>
<div class="line">REQUIRE( i == 42 );</div>
</div><!-- fragment --><ul>
<li><b>REQUIRE_FALSE(** <em>expression</em> **)</b> and <br  />
</li>
<li><b>CHECK_FALSE(** <em>expression</em> **)</b></li>
</ul>
<p>Evaluates the expression and records the <em>logical NOT</em> of the result. If an exception is thrown it is caught, reported, and counted as a failure. (these forms exist as a workaround for the fact that ! prefixed expressions cannot be decomposed).</p>
<p>Example: </p><div class="fragment"><div class="line">REQUIRE_FALSE( thisReturnsFalse() );</div>
</div><!-- fragment --><p>Do note that "overly complex" expressions cannot be decomposed and thus will not compile. This is done partly for practical reasons (to keep the underlying expression template machinery to minimum) and partly for philosophical reasons (assertions should be simple and deterministic).</p>
<p>Examples:</p><ul>
<li><code>CHECK(a == 1 &amp;&amp; b == 2);</code> This expression is too complex because of the <code>&amp;&amp;</code> operator. If you want to check that 2 or more properties hold, you can either put the expression into parenthesis, which stops decomposition from working, or you need to decompose the expression into two assertions: <code>CHECK( a == 1 ); CHECK( b == 2);</code></li>
<li><code>CHECK( a == 2 || b == 1 );</code> This expression is too complex because of the <code>||</code> operator. If you want to check that one of several properties hold, you can put the expression into parenthesis (unlike with <code>&amp;&amp;</code>, expression decomposition into several <code>CHECK</code>s is not possible).</li>
</ul>
<h3>Floating point comparisons</h3>
<p>When comparing floating point numbers - especially if at least one of them has been computed - great care must be taken to allow for rounding errors and inexact representations.</p>
<p><a class="el" href="namespace_catch.html">Catch</a> provides a way to perform tolerant comparisons of floating point values through use of a wrapper class called <code>Approx</code>. <code>Approx</code> can be used on either side of a comparison expression. It overloads the comparisons operators to take a tolerance into account. Here's a simple example:</p>
<div class="fragment"><div class="line">REQUIRE( performComputation() == Approx( 2.1 ) );</div>
</div><!-- fragment --><p>This way <code>Approx</code> is constructed with reasonable defaults, covering most simple cases of rounding errors. If these are insufficient, each <code>Approx</code> instance has 3 tuning knobs, that can be used to customize it for your computation.</p>
<ul>
<li><b>epsilon</b> - epsilon serves to set the percentage by which a result can be erroneous, before it is rejected. By default set to <code>std::numeric_limits&lt;float&gt;::epsilon()*100</code>.</li>
<li><b>margin</b> - margin serves to set the the absolute value by which a result can be erroneous before it is rejected. By default set to <code>0.0</code>.</li>
<li><b>scale</b> - scale serves to adjust the epsilon's multiplicator. By default set to <code>0.0</code>.</li>
</ul>
<h4>epsilon example</h4>
<div class="fragment"><div class="line">Approx target = Approx(100).epsilon(0.01);</div>
<div class="line">100.0 == target; <span class="comment">// Obviously true</span></div>
<div class="line">200.0 == target; <span class="comment">// Obviously still false</span></div>
<div class="line">100.5 == target; <span class="comment">// True, because we set target to allow up to 1% error</span></div>
</div><!-- fragment --><h4>margin example</h4>
<p><em>Margin check is used only if the relative (epsilon and scale based) check fails.</em> </p><div class="fragment"><div class="line">Approx target = Approx(100).margin(5);</div>
<div class="line">100.0 == target; <span class="comment">// Obviously true</span></div>
<div class="line">200.0 == target; <span class="comment">// Obviously still false</span></div>
<div class="line">104.0 == target; <span class="comment">// True, because we set target to allow absolute error up to 5</span></div>
</div><!-- fragment --><h4>scale</h4>
<p>Scale can be useful if the computation leading to the result worked on different scale than is used by the results. Since allowed difference between Approx's value and compared value is based primarily on Approx's value (the allowed difference is computed as <code>(Approx::scale + Approx::value) * epsilon</code>), the resulting comparison could need rescaling to be correct.</p>
<h2>Exceptions</h2>
<ul>
<li><b>REQUIRE_NOTHROW(** <em>expression</em> **)</b> and <br  />
</li>
<li><b>CHECK_NOTHROW(** <em>expression</em> **)</b></li>
</ul>
<p>Expects that no exception is thrown during evaluation of the expression.</p>
<ul>
<li><b>REQUIRE_THROWS(** <em>expression</em> **)</b> and <br  />
</li>
<li><b>CHECK_THROWS(** <em>expression</em> **)</b></li>
</ul>
<p>Expects that an exception (of any type) is be thrown during evaluation of the expression.</p>
<ul>
<li><b>REQUIRE_THROWS_AS(** <em>expression</em>, <em>exception type</em> **)</b> and <br  />
</li>
<li><b>CHECK_THROWS_AS(** <em>expression</em>, <em>exception type</em> **)</b></li>
</ul>
<p>Expects that an exception of the <em>specified type</em> is thrown during evaluation of the expression. Note that the <em>exception type</em> is extended with <code>const&amp;</code> and you should not include it yourself.</p>
<ul>
<li><b>REQUIRE_THROWS_WITH(** <em>expression</em>, <em>string or string matcher</em> **)</b> and <br  />
</li>
<li><b>CHECK_THROWS_WITH(** <em>expression</em>, <em>string or string matcher</em> **)</b></li>
</ul>
<p>Expects that an exception is thrown that, when converted to a string, matches the <em>string</em> or <em>string matcher</em> provided (see next section for Matchers).</p>
<p>e.g. </p><div class="fragment"><div class="line"><a class="code" href="include_2catch_8hpp.html#aa39a017db507132071d2819f087b2f28">REQUIRE_THROWS_WITH</a>( openThePodBayDoors(), <a class="code" href="namespace_catch_1_1_matchers.html#a1f6c2accdc6cd75a84d7112dcad647b4">Contains</a>( <span class="stringliteral">&quot;afraid&quot;</span> ) &amp;&amp; <a class="code" href="namespace_catch_1_1_matchers.html#a1f6c2accdc6cd75a84d7112dcad647b4">Contains</a>( <span class="stringliteral">&quot;can&#39;t do that&quot;</span> ) );</div>
<div class="line"><a class="code" href="include_2catch_8hpp.html#aa39a017db507132071d2819f087b2f28">REQUIRE_THROWS_WITH</a>( dismantleHal(), <span class="stringliteral">&quot;My mind is going&quot;</span> );</div>
</div><!-- fragment --><ul>
<li><b>REQUIRE_THROWS_MATCHES(** <em>expression</em>, <em>exception type</em>, <em>matcher for given exception type</em> **)</b> and</li>
<li><b>CHECK_THROWS_MATCHES(** <em>expression</em>, <em>exception type</em>, <em>matcher for given exception type</em> **)</b></li>
</ul>
<p>Expects that exception of <em>exception type</em> is thrown and it matches provided matcher (see next section for Matchers).</p>
<p><em>Please note that the <code>THROW</code> family of assertions expects to be passed a single expression, not a statement or series of statements. If you want to check a more complicated sequence of operations, you can use a C++11 lambda function.</em></p>
<div class="fragment"><div class="line"><a class="code" href="include_2catch_8hpp.html#ab0148f0dfca438f7aa01974e9c33216a">REQUIRE_NOTHROW</a>([&amp;](){</div>
<div class="line">    <span class="keywordtype">int</span> i = 1;</div>
<div class="line">    <span class="keywordtype">int</span> j = 2;</div>
<div class="line">    <span class="keyword">auto</span> k = i + j;</div>
<div class="line">    <span class="keywordflow">if</span> (k == 3) {</div>
<div class="line">        <span class="keywordflow">throw</span> 1;</div>
<div class="line">    }</div>
<div class="line">}());</div>
</div><!-- fragment --><h2>Matcher expressions</h2>
<p>To support Matchers a slightly different form is used. Matchers have <a href="matchers.md#top">their own documentation</a>.</p>
<ul>
<li><b>REQUIRE_THAT(** <em>lhs</em>, <em>matcher expression</em> **)</b> and <br  />
</li>
<li><b>CHECK_THAT(** <em>lhs</em>, <em>matcher expression</em> **)</b> <br  />
</li>
</ul>
<p>Matchers can be composed using <code>&amp;&amp;</code>, <code>||</code> and <code>!</code> operators.</p>
<h2>Thread Safety</h2>
<p>Currently assertions in <a class="el" href="namespace_catch.html">Catch</a> are not thread safe. For more details, along with workarounds, see the section on <a href="limitations.md#thread-safe-assertions">the limitations page</a>.</p>
<hr  />
<p><a href="Readme.md#top">Home</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="ainclude_2catch_8hpp_html_aa39a017db507132071d2819f087b2f28"><div class="ttname"><a href="include_2catch_8hpp.html#aa39a017db507132071d2819f087b2f28">REQUIRE_THROWS_WITH</a></div><div class="ttdeci">#define REQUIRE_THROWS_WITH(expr, matcher)</div><div class="ttdef"><b>Definition:</b> catch.hpp:11814</div></div>
<div class="ttc" id="ainclude_2catch_8hpp_html_ab0148f0dfca438f7aa01974e9c33216a"><div class="ttname"><a href="include_2catch_8hpp.html#ab0148f0dfca438f7aa01974e9c33216a">REQUIRE_NOTHROW</a></div><div class="ttdeci">#define REQUIRE_NOTHROW(...)</div><div class="ttdef"><b>Definition:</b> catch.hpp:11818</div></div>
<div class="ttc" id="anamespace_catch_1_1_matchers_html_a1f6c2accdc6cd75a84d7112dcad647b4"><div class="ttname"><a href="namespace_catch_1_1_matchers.html#a1f6c2accdc6cd75a84d7112dcad647b4">Catch::Matchers::Contains</a></div><div class="ttdeci">StdString::ContainsMatcher Contains(std::string const &amp;str, CaseSensitive::Choice caseSensitivity=CaseSensitive::Yes)</div><div class="ttdef"><b>Definition:</b> catch_matchers_string.cpp:83</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
